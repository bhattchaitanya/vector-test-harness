#!/bin/bash
set -euo pipefail

# Init lib.
# shellcheck source=SCRIPTDIR/../lib/vector-test-harness/init.sh
source "$(cd "$(dirname "${BASH_SOURCE[0]}")" >/dev/null 2>&1 && pwd)/../lib/vector-test-harness/init.sh"

# Setup

OPTS=(
  -o "User=ubuntu"
)

if [[ -n "${VECTOR_TEST_PRIV_KEY:-""}" ]]; then
  OPTS+=(-o "IdentityFile=$VECTOR_TEST_PRIV_KEY")
  OPTS+=(-o "IdentitiesOnly=yes")
fi

# Execute

exec ssh "${OPTS[@]}" "$@"
